# Migration `20200626110510`

This migration has been generated by William Lindvall at 6/26/2020, 11:05:10 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Note" (
"authorId" integer  NOT NULL ,"color" text  NOT NULL ,"content" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"font" text  NOT NULL ,"id" SERIAL,"style" text  NOT NULL ,"userId" integer   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Reply" (
"authorId" integer  NOT NULL ,"content" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"noteId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Tag" (
"title" text  NOT NULL ,
    PRIMARY KEY ("title"))

CREATE TABLE "public"."User" (
"avatar" integer  NOT NULL ,"city" text  NOT NULL ,"coords" text []  ,"country" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"id" SERIAL,"nickname" text  NOT NULL ,"password" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_NoteToTag" (
"A" integer  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_OpenedNotes" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE TABLE "public"."_TagToUser" (
"A" text  NOT NULL ,"B" integer  NOT NULL )

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "_NoteToTag_AB_unique" ON "public"."_NoteToTag"("A","B")

CREATE  INDEX "_NoteToTag_B_index" ON "public"."_NoteToTag"("B")

CREATE UNIQUE INDEX "_OpenedNotes_AB_unique" ON "public"."_OpenedNotes"("A","B")

CREATE  INDEX "_OpenedNotes_B_index" ON "public"."_OpenedNotes"("B")

CREATE UNIQUE INDEX "_TagToUser_AB_unique" ON "public"."_TagToUser"("A","B")

CREATE  INDEX "_TagToUser_B_index" ON "public"."_TagToUser"("B")

ALTER TABLE "public"."Note" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Note" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Reply" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Reply" ADD FOREIGN KEY ("noteId")REFERENCES "public"."Note"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_NoteToTag" ADD FOREIGN KEY ("A")REFERENCES "public"."Note"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_NoteToTag" ADD FOREIGN KEY ("B")REFERENCES "public"."Tag"("title") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_OpenedNotes" ADD FOREIGN KEY ("A")REFERENCES "public"."Note"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_OpenedNotes" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_TagToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Tag"("title") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_TagToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200626110510
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,56 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model Note {
+  author       User      @relation("WrittenNotes", fields: [authorId], references: [id])
+  authorId     Int
+  color        String
+  content      String
+  createdAt    DateTime  @default(now())
+  font         String
+  id           Int       @default(autoincrement()) @id
+  style        String
+  replies      Reply[]
+  tags         Tag[]     @relation(references: [title])
+
+  viewers      User[]    @relation("OpenedNotes", references: [id])
+}
+
+
+model Reply {
+  author       User      @relation(fields: [authorId], references: [id])
+  authorId     Int
+  content      String
+  createdAt    DateTime  @default(now())
+  id           Int       @default(autoincrement()) @id
+  noteId       Int
+  note         Note      @relation(fields: [noteId], references: [id])
+}
+
+model Tag {
+  title        String  @id
+  notes        Note[]
+  users        User[]
+}
+
+model User {
+  avatar       Int
+  bookmarks    Note[]    @relation("PinnedNotes")
+  city         String
+  coords       String[]
+  country      String
+  createdAt    DateTime  @default(now())
+  email        String    @unique
+  id           Int       @default(autoincrement()) @id
+  nickname     String
+  notes        Note[]    @relation("WrittenNotes")
+  password     String
+  interests    Tag[]     @relation(references: [title])
+  openedNotes  Note[]    @relation("OpenedNotes")
+}
```


